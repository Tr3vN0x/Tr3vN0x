<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tr3vN0x Official Website - Cyber Edition</title>
<style>
/* ---------------- GLOBAL ---------------- */
body {
    margin: 0;
    font-family: 'Consolas', 'Courier New', monospace; /* Cooler Monospace Font */
    background: #0a0a0a;
    color: #00ff66;
    scroll-behavior: smooth;
}

/* ---------------- SPLASH SCREEN ---------------- */
#splash-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #0a0a0a;
    z-index: 1000;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    opacity: 1;
    transition: opacity 0.5s ease-out;
}

.splash-content {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.splash-logo {
    max-width: 90%;
    height: auto;
    max-height: 120px;
    margin-bottom: 25px;
    border-radius: 4px;
    border: 1px solid #00ff66;
    box-shadow: 0 0 12px #00ff66;
    animation: pulse 1.5s infinite alternate;
}

@keyframes pulse {
    from { transform: scale(1); box-shadow: 0 0 8px #00ff66; }
    to { transform: scale(1.05); box-shadow: 0 0 16px #00ff66; }
}

#loading-percentage {
    font-size: 2.5em;
    font-weight: bold;
    color: #00ff66;
    text-shadow: 0 0 10px #00ff66;
}

/* ---------------- MAIN CONTENT WRAPPER ---------------- */
#main-content {
    opacity: 0;
    transition: opacity 1s ease-in;
}

/* ---------------- HEADER ---------------- */
header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 30px; /* Increased padding */
    background: #0d0d0d;
    border-bottom: 2px solid #003300;
    position: sticky;
    top: 0;
    z-index: 10;
    flex-wrap: wrap;
}

.logo-container {
    display: flex;
    align-items: center;
    gap: 12px;
}

/* NEW STYLES FOR THE ADDED IMAGE */
.side-image {
    width: 60px; /* Medium size */
    height: 60px; /* Medium size */
    object-fit: cover;
    border-radius: 50%; /* Make it circular for a cool look */
    border: 2px solid #00ff66;
    margin-right: 15px; /* Spacing between the new image and the logo */
    box-shadow: 0 0 10px #00ff66;
    animation: rotate 8s linear infinite; /* Optional: adds a cyber feel */
}

@keyframes rotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.logo-container img {
    height: 50px;
    border-radius: 4px;
    border: 1px solid #00ff66;
    box-shadow: 0 0 8px #00ff66;
}

.search-bar {
    background: #111;
    border: 1px solid #004400;
    border-radius: 8px;
    padding: 8px 14px;
    width: 250px;
    color: #00ff66;
    caret-color: #00ff66;
    transition: 0.3s;
    margin: 8px 0;
}

.search-bar::placeholder { color: #004400; }
.search-bar:focus { border-color: #00ff66; box-shadow: 0 0 12px #00ff66; outline: none; }

.profile-btn {
    width: 60px;
    height: 60px;
    cursor: pointer;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: 0.3s;
    padding: 4px;
    background: #111;
}

.profile-btn img {
    width: 100%;
    height: auto;
    max-height: 100%;
    object-fit: contain;
    filter: drop-shadow(0 0 6px #00ff66);
}

.profile-btn:hover {
    background: #003300;
    box-shadow: 0 0 12px #00ff66;
}

/* ---------------- ROWS - FIXED LAYOUT ---------------- */
.row-container {
    display: flex;
    align-items: flex-start;
    padding: 30px 20px; /* Increased vertical padding for space */
    gap: 20px; /* Increased gap between label and video row */
    max-width: 1400px; /* Max width for central content */
    margin: 0 auto; /* Center the content */
}

.row-label {
    writing-mode: vertical-rl;
    transform: rotate(180deg);
    font-weight: bold;
    font-size: 20px;
    letter-spacing: 2px;
    color: #00ff66;
    min-width: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px 0;
    border-right: 2px solid #004400; /* Subtle separator */
}

.video-row {
    /* KEY CHANGE: Use Grid for 4 columns */
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* 4 equal columns */
    gap: 20px; /* Gap between video cards */
    overflow-x: hidden; /* Remove horizontal scroll on desktop */
    padding-bottom: 0;
    width: 100%;
}

.video-row::-webkit-scrollbar {
    display: none;
}

.video-card {
    background: #111;
    border: 1px solid #003300;
    border-radius: 12px;
    min-width: 100%;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s, border-color 0.3s;
    position: relative;
    padding-bottom: 0;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.video-card:hover {
    transform: translateY(-5px); /* Lift up effect for "cool" */
    box-shadow: 0 5px 20px rgba(0, 255, 102, 0.4);
    border-color: #00ff66; /* Highlight border */
}

.thumbnail-container {
    position: relative;
    width: 100%;
    padding-top: 56.25%; /* 16:9 Aspect Ratio */
    height: 0;
    border-radius: 10px 10px 0 0;
    overflow: hidden;
}

.thumbnail-container img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.thumbnail-container .hover-thumb {
    opacity: 0;
    pointer-events: none;
    transition: 0.3s;
}

.thumbnail-container:hover .hover-thumb {
    opacity: 1;
}

.video-title {
    margin: 10px 8px 4px;
    font-weight: bold;
    font-size: 1.1em;
    color: #00ff66;
    text-shadow: 0 0 4px rgba(0, 255, 102, 0.5);
    text-align: left;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

/* ---------------- VIEW COUNTER ---------------- */
.video-views {
    text-align: left;
    font-size: 0.85em;
    color: #00ff66;
    margin: 0 8px 10px;
    opacity: 0.7;
    text-shadow: none;
}

/* Favorites icon */
.favorite-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 28px;
    height: 28px;
    z-index: 5;
    cursor: pointer;
    filter: drop-shadow(0 0 4px #00ff66);
    background-color: rgba(17, 17, 17, 0.8);
    border-radius: 50%;
    padding: 3px;
}

.favorite-btn.favorited {
    filter: drop-shadow(0 0 6px #ff00ff);
}

/* ---------------- PROFILE MODAL ---------------- */
#profile-modal {
    display: none;
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: rgba(0,0,0,0.95);
    justify-content: center;
    align-items: center;
    z-index: 100;
}

#profile-modal .modal-content {
    background: #111;
    padding: 25px;
    border-radius: 12px;
    text-align: center;
    width: 90%;
    max-width: 400px;
    border: 1px solid #003300;
    box-shadow: 0 0 20px #00ff66;
}

#profile-modal h2 {
    font-size: 24px;
    margin-bottom: 10px;
}

.profile-picture {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #00ff66;
    margin-bottom: 12px;
}

.verified-badge {
    background: #00ff66;
    color: #0a0a0a;
    font-weight: bold;
    font-size: 12px;
    padding: 2px 6px;
    border-radius: 4px;
    margin-left: 8px;
}

.followers {
    margin: 10px 0;
}

.follow-btn {
    padding: 8px 16px;
    background: #111;
    border: 1px solid #00ff66;
    color: #00ff66;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
    margin-bottom: 15px;
    transition: 0.3s;
}

.follow-btn:hover {
    background: #003300;
    box-shadow: 0 0 10px #00ff66;
}

.follow-btn:disabled {
    background: #002200;
    color: #00aa00;
    cursor: default;
    box-shadow: none;
}

.links a {
    display: inline-block;
    margin: 5px 10px;
    color: #00ff66;
    text-decoration: none;
    font-weight: bold;
}

.links a:hover {
    text-decoration: underline;
}

#profile-modal .close-btn {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 28px;
    color: #00ff66;
    cursor: pointer;
    font-weight: bold;
}

/* ---------------- FOOTER ---------------- */
footer {
    text-align: center;
    padding: 25px;
    background: #0d0d0d;
    border-top: 2px solid #003300;
    color: #00ff66;
    font-weight: bold;
    text-shadow: 0 0 4px #00ff66;
    margin-top: 20px;
}

/* ---------------- MODAL PLAYER ---------------- */
#video-modal {
    display: none;
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: rgba(0,0,0,0.9);
    justify-content: center;
    align-items: center;
    z-index: 99;
}

#video-modal iframe {
    width: 90%;
    max-width: 800px;
    aspect-ratio: 16/9;
    border:none;
    border-radius: 10px;
    box-shadow: 0 0 25px #00ff66;
}

#video-modal .close-btn {
    position: absolute;
    top: 20px;
    right: 30px;
    font-size: 28px;
    color: #00ff66;
    cursor: pointer;
    font-weight: bold;
    text-shadow: 0 0 5px #00ff66;
}

/* ---------------- RESPONSIVE ---------------- */
@media (max-width: 1200px) {
    /* Switch to 3 columns on smaller desktops/large tablets */
    .video-row {
        grid-template-columns: repeat(3, 1fr);
    }
}

@media (max-width: 900px) {
    /* Switch to 2 columns on tablets */
    .video-row {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 768px) {
    header { flex-direction: column; align-items: center; }
    .search-bar { width: 90%; }
    /* Horizontal Layout on Mobile */
    .row-container { flex-direction: column; padding: 15px 10px; }
    .row-label { 
        writing-mode: horizontal-tb; 
        transform: none; 
        min-width: auto; 
        padding-bottom: 5px;
        border-right: none;
        border-bottom: 2px solid #004400; /* New separator */
        text-align: center;
        margin-bottom: 10px;
    }
    .video-row { 
        /* Back to horizontal scroll for mobile to keep the cards a decent size */
        display: flex;
        gap: 15px;
        overflow-x: auto;
        padding-bottom: 10px;
        grid-template-columns: none;
    }
    .video-card {
        min-width: 240px; /* Fixed width for better horizontal scrolling on mobile */
    }
}
</style>
</head>
<body>

<div id="splash-screen">
    <div class="splash-content">
        <img src="https://see.fontimg.com/api/rf5/vXL4/YTM3ZmYyMWFkMzNiNGY5MGEwY2ZmZTZmNDhiZGI4NzkudHRm/VHIzdk4weA/chimpanzee-website-report.png?r=fs&h=65&w=1000&fg=E8E4E4&bg=27E2A1&tb=1&s=65" alt="Tr3vN0x Logo" class="splash-logo">
        <div id="loading-percentage">0%</div>
    </div>
</div>

<main id="main-content">

    <header>
        <div class="logo-container">
            <img src="https://scontent-iad3-2.xx.fbcdn.net/v/t39.30808-1/596009832_838710972097270_9022730636766278745_n.jpg?stp=c142.157.732.731a_dst-jpg_s200x200_tt6&_nc_cat=100&ccb=1-7&_nc_sid=1d2534&_nc_ohc=TZjP9DC4yXIQ7kNvwFEcY_x&_nc_oc=AdlXCvH1Xc6OtBrkXSWPLBU6L751ZvM61n3S7NwmKzua-aeulDmjQ2t_MI1B-sXtRN_x57v0LAV2h5Cn1fUqYMoT&_nc_zt=24&_nc_ht=scontent-iad3-2.xx&_nc_gid=zM9e1vkNGeRNIUfsHkDVoA&oh=00_AfkVNvtwYSd4uOnADbDaRB7cLJm0mphwfYnpm8nridyEug&oe=6939DC00" class="side-image">
            
            <img src="https://see.fontimg.com/api/rf5/vXL4/YTM3ZmYyMWFkMzNiNGY5MGEwY2ZmZTZmNDhiZGI4NzkudHRm/VHIzdk4weA/chimpanzee-website-report.png?r=fs&h=65&w=1000&fg=E8E4E4&bg=27E2A1&tb=1&s=65" alt="Site Logo">
        </div>

        <input type="text" class="search-bar" placeholder="Search videos...">

        <div class="profile-btn" id="open-profile">
            <img src="https://see.fontimg.com/api/rf5/vXL4/YTM3ZmYyMWFkMzNiNGY5MGEwY2ZmZTZmNDhiZGI4NzkudHRm/UHJvZmlsZQ/chimpanzee-website-report.png?r=fs&h=65&w=1000&fg=E8E4E4&bg=27E2A1&tb=1&s=65" alt="Profile Icon">
        </div>
    </header>
    
    <div class="row-container">
        <div class="row-label">Newest Videos</div>
        <div class="video-row" id="newest-videos-row"></div>
    </div>

    <div class="row-container">
        <div class="row-label">Most Viewed</div>
        <div class="video-row" id="most-viewed-row"></div>
    </div>

    <div class="row-container">
        <div class="row-label">Favorites</div>
        <div class="video-row" id="favorites-row"></div>
    </div>

    <div class="row-container">
        <div class="row-label">Older Videos</div>
        <div class="video-row" id="older-videos-row"></div>
    </div>

    <div class="row-container">
        <div class="row-label">Watch History</div>
        <div class="video-row" id="watch-history-row"></div>
    </div>

    <div id="video-modal">
        <div class="close-btn">&times;</div>
        <iframe src="" allowfullscreen></iframe>
    </div>

    <div id="profile-modal">
        <div class="modal-content">
            <div class="close-btn">&times;</div>
            <img src="https://scontent-iad3-2.xx.fbcdn.net/v/t39.30808-6/590086895_835846532383714_4499501150848421010_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=833d8&_nc_ohc=Kjd5106wWUUQ7kNvwGY4KdI&_nc_oc=Adn-ZpH21jojHfsJiONHnGqW2-PZfGjDnHtpv7AALDDAhE8LBXTvIe1Yze_i45z-s66KSXnu8kk0XVv5XkfG95AC&_nc_zt=23&_nc_ht=scontent-iad3-2.xx&_nc_gid=ZLmUJVBql1dhtmAYTmclXQ&oh=00_AfnUki9lotlZWgh6nkZf0VzKWY0Hy4rXxzTpOPP8CY1yJQ&oe=69387882" alt="Profile Picture" class="profile-picture">
            <h2>Tr3vN0x <span class="verified-badge">Verified</span></h2>
            <div class="followers">Followers: <span id="followers-count">0</span> | Following: 0</div>
            <button class="follow-btn" id="follow-btn">Follow</button>
            <div class="links">
                <p>Hey, you found me! I want to thank you so much for the support, but also you mean alot to everyone around you. Yeah life may get tough motivate yourself, and live the dreams you want. Not everyday will be easy, but belive and you will achieve greatness...</p>
                <a href="https://x.com/@Tr3vN0x" target="_blank">Twitter</a>
                <a href="https://youtube.com/@Tr3vN0x" target="_blank">YouTube</a>
            </div>
        </div>
    </div>

    <footer>
        Â© 2025 Tr3vN0x â€” All Rights Reserved
    </footer>
</main>

<script>
// --- LOADING SCRIPT ---
document.addEventListener('DOMContentLoaded', () => {
    const splashScreen = document.getElementById('splash-screen');
    const mainContent = document.getElementById('main-content');
    const loadingPercentage = document.getElementById('loading-percentage');
    
    mainContent.style.opacity = '0';
    mainContent.style.pointerEvents = 'none';

    const MIN_LOAD_TIME_MS = 2000;  
    const MAX_PERCENTAGE = 100;
    let currentPercentage = 0;
    const startTime = Date.now();

    function animateLoading() {
        const elapsedTime = Date.now() - startTime;
        let targetPercentage = Math.min(
            Math.floor((elapsedTime / MIN_LOAD_TIME_MS) * MAX_PERCENTAGE), 
            MAX_PERCENTAGE
        );
        if (targetPercentage >= currentPercentage) {
            currentPercentage = targetPercentage;
            loadingPercentage.textContent = `${currentPercentage}%`;
        }
        if (currentPercentage < MAX_PERCENTAGE) {
            requestAnimationFrame(animateLoading);
        } else {
            setTimeout(() => {
                splashScreen.style.opacity = '0';
                mainContent.style.opacity = '1';
                mainContent.style.pointerEvents = 'auto'; 
                setTimeout(() => { splashScreen.style.display = 'none'; }, 500);
            }, 300);
        }
    }
    animateLoading();
});

// ---------------- PERSISTENT VIEW COUNT SIMULATION ----------------
/**
 * Since a real database cannot be used in static HTML/JS, 
 * this simulates persistent views using localStorage.
 */
function getPersistentViews(videoId) {
    const key = `views_${videoId}`;
    let views = localStorage.getItem(key);
    
    if (views === null) {
        // If first time loading, generate a random starting view count (simulating an existing database)
        views = Math.floor(Math.random() * 5000) + 100;
        localStorage.setItem(key, views);
    }
    return parseInt(views);
}

function updatePersistentViews(videoId, currentViews) {
    const key = `views_${videoId}`;
    localStorage.setItem(key, currentViews);
}

// ---------------- DATA SETUP ----------------

// Initial Data structure (views are initialized from localStorage/randomized)
const favorites = [];

// .map is used to iterate over the videos and assign the initial view count 
const newestVideos = [
    {id:"92y9uaQMIa8", title:"I PLAYED ROBLOX DEAD BY DAYLIGHT (IT WAS SCARY)"},
    {id:"RODulIl7-gg", title:"I JOINED THE ROBLOX FOOTBALL LEAGUE (IT WENT TERRIBLE)"},
].map(v => ({...v, views: getPersistentViews(v.id)}));

const mostViewed = [
    {id:"Uwwga_CiFqc", title:"Why Is Flee the Facility THIS Stressful?! ðŸ˜¤ðŸ”¥"},
    {id:"J-W0Vfrc26U", title:"Nobody Could Stop Meâ€¦ (Sniper Only Challenge ðŸ’€)"},
    {id:"ZiEd3RoiKtk", title:"Who Is TR3VN0X? (Robloxâ€™s Funniest New YouTuber ðŸ’€)"},
    // Use unique IDs for duplicates to allow individual view tracking
    {id:"ZiEd3RoiKtk_dup", title:"Who Is TR3VN0X? (Robloxâ€™s Funniest New YouTuber ðŸ’€)"}, 
].map(v => ({...v, views: getPersistentViews(v.id)}));

const olderVideos = [
    {id:"ZiEd3RoiKtk_old", title:"Who Is TR3VN0X? (Robloxâ€™s Funniest New YouTuber ðŸ’€)"},
    {id:"J-W0Vfrc26U_old", title:"Nobody Could Stop Meâ€¦ (Sniper Only Challenge ðŸ’€)"},
    {id:"Uwwga_CiFqc_old", title:"Why Is Flee the Facility THIS Stressful?! ðŸ˜¤ðŸ”¥"},
    {id:"Sn4dyr5v7m0", title:"ROBLOX BREAKING POINT"},
    {id:"XqmcBMy3X1k", title:"I'm taking a break..."},
    {id:"c5QYm0cxlqE", title:"My struggle wih anxiety..."},
    {id:"kNkK_qclihc", title:"ROBLOXIAN HIGHSCHOOL *LIVE*"},
].map(v => ({...v, views: getPersistentViews(v.id)}));

const watchHistory = [];

// ---------------- VIDEO RENDER ----------------
function createVideoCard(video) {
    if(video.views === undefined) video.views = 0;

    const card = document.createElement('div');
    card.className = 'video-card';
    card.setAttribute('data-video', video.id);
    
    // Clean up ID for thumbnail source: remove simulated suffix if it exists (e.g., _dup, _old)
    const thumbnailId = video.id.replace(/_dup$|_old$/, '');

    card.innerHTML = `
        <div class="thumbnail-container">
            <img class="thumb" src="https://img.youtube.com/vi/${thumbnailId}/mqdefault.jpg" alt="${video.title} thumbnail">
            <img class="hover-thumb" src="https://img.youtube.com/vi/${thumbnailId}/hqdefault.jpg" alt="${video.title} high quality thumbnail">
        </div>
        <div class="video-info-wrapper">
            <div class="video-title">${video.title}</div>
            <div class="video-views">Views: ${video.views}</div>
        </div>
        <img src="https://cdn-icons-png.flaticon.com/512/1077/1077035.png" class="favorite-btn" alt="Favorite button">
    `;
    const favoriteBtn = card.querySelector('.favorite-btn');
    
    // Set initial favorite state
    if (favorites.find(v => v.id === video.id)) {
        favoriteBtn.classList.add('favorited');
    }

    favoriteBtn.addEventListener('click', e=>{
        e.stopPropagation();
        const index = favorites.findIndex(v=>v.id===video.id);

        if(index === -1){
            // Not favorited, so add it
            favorites.push(video);
            favoriteBtn.classList.add('favorited');
        } else {
            // Already favorited, so remove it
            favorites.splice(index,1);
            favoriteBtn.classList.remove('favorited');
        }
        renderFavorites(); // Re-render favorites row
        // Update the button state across all copies of this video
        document.querySelectorAll(`.video-card[data-video="${video.id}"] .favorite-btn`).forEach(btn => {
             if (favorites.find(v => v.id === video.id)) {
                btn.classList.add('favorited');
            } else {
                btn.classList.remove('favorited');
            }
        });
    });

    card.addEventListener('click',()=>{
        const modal = document.getElementById('video-modal');
        // Use the base video ID for the embed URL 
        modal.querySelector('iframe').src = `https://www.youtube.com/embed/${thumbnailId}?autoplay=1`;
        modal.style.display = 'flex';

        // **** PERSISTENT VIEW COUNT LOGIC ****
        
        // 1. Update the local video object's view count
        video.views++;
        
        // 2. Update the persistent store (localStorage simulation)
        updatePersistentViews(video.id, video.views);

        // 3. Update the display on ALL visible cards that show this video ID
        document.querySelectorAll(`.video-card[data-video="${video.id}"] .video-views`).forEach(el => {
            el.textContent = `Views: ${video.views}`;
        });
        
        // 4. Update watch history 
        if(!watchHistory.find(v=>v.id===video.id)){
            watchHistory.unshift({...video}); // Add a clone to keep the current view count in the history list
        }
        renderRow('watch-history-row', watchHistory);
    });
    return card;
}

function renderRow(rowId, videos){
    const row = document.getElementById(rowId);
    row.innerHTML = '';
    // Ensure we render the videos with their latest views
    videos.forEach(v=>{
        row.appendChild(createVideoCard(v));
    });
}

function renderFavorites(){
    // Re-render the favorites row based on the current favorites array
    renderRow('favorites-row', favorites);
}

// ---------------- INITIAL RENDER ----------------
renderRow('newest-videos-row', newestVideos);
renderRow('most-viewed-row', mostViewed);
renderRow('older-videos-row', olderVideos);
renderFavorites();
renderRow('watch-history-row', watchHistory);

// ---------------- MODAL LOGIC ----------------
const modal = document.getElementById('video-modal');
modal.querySelector('.close-btn').addEventListener('click', ()=>{
    modal.querySelector('iframe').src = '';
    modal.style.display = 'none';
});
modal.addEventListener('click', e=>{
    if(e.target === modal){
        modal.querySelector('iframe').src = '';
        modal.style.display = 'none';
    }
});

// ---------------- SEARCH ----------------
const searchInput = document.querySelector('.search-bar');
searchInput.addEventListener('input', () => {
    const query = searchInput.value.toLowerCase();
    
    // Combine all videos for search filtering
    const allVideos = [...newestVideos, ...mostViewed, ...olderVideos, ...favorites, ...watchHistory];
    
    // Create an object to hold unique video IDs as keys and their corresponding objects
    const uniqueVideosMap = new Map();
    allVideos.forEach(video => {
        if (!uniqueVideosMap.has(video.id)) {
            uniqueVideosMap.set(video.id, video);
        }
    });

    // Convert map values back to an array for filtering
    const uniqueVideos = Array.from(uniqueVideosMap.values());
    const filteredVideos = uniqueVideos.filter(v=>v.title.toLowerCase().includes(query));

    // For demonstration, we'll only display filtered videos in the 'Most Viewed' row.
    // In a real app, you might show a dedicated 'Search Results' page.
    if (query.length > 0) {
        // Hide all rows except the header
        document.querySelectorAll('.row-container').forEach(row => row.style.display = 'none');
        
        // Temporarily display results in the Most Viewed container
        document.querySelector('.row-container:nth-of-type(2)').style.display = 'flex';
        document.querySelector('.row-container:nth-of-type(2) .row-label').textContent = 'Search Results';
        renderRow('most-viewed-row', filteredVideos);

    } else {
        // Show all rows when the search bar is empty
        document.querySelectorAll('.row-container').forEach(row => row.style.display = 'flex');
        document.querySelector('.row-container:nth-of-type(2) .row-label').textContent = 'Most Viewed';
        
        // Re-render all original rows
        renderRow('newest-videos-row', newestVideos);
        renderRow('most-viewed-row', mostViewed);
        renderRow('older-videos-row', olderVideos);
        renderFavorites();
        renderRow('watch-history-row', watchHistory);
    }
});


// ---------------- PROFILE MODAL ----------------
const profileModal = document.getElementById('profile-modal');
document.getElementById('open-profile').addEventListener('click',()=> profileModal.style.display='flex');
document.querySelector('#profile-modal .close-btn').addEventListener('click',()=> profileModal.style.display='none');
profileModal.addEventListener('click', e => { if(e.target===profileModal) profileModal.style.display='none'; });
document.addEventListener('keydown', e => { if(e.key==='Escape' && profileModal.style.display === 'flex') profileModal.style.display='none'; });

// ---------------- FOLLOW BUTTON ----------------
const followBtn = document.getElementById('follow-btn');
const followersCount = document.getElementById('followers-count');
let followers = 0;

followBtn.addEventListener('click', ()=>{
    if (!followBtn.disabled) {
        followers++;
        followersCount.textContent = followers;
        followBtn.disabled = true;
        followBtn.textContent = 'Following';
    }
});
</script>

</body>
</html>

